<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4444&amp;path=livereload" data-no-instant defer></script>

	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<title>Sysinternals - Cyberdefenders (Medium) |  fafi </title>
    

	<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
    <link rel="android-chrome-192x192" type="image/png" sizes="192x192" href="/images/android-chrome-192x192.png">
    <link rel="android-chrome-512x512" type="image/png" sizes="512x512" href="/images/android-chrome-512x512.png">
    <link rel="manifest" href="/images/site.webmanifest">

	<link rel="stylesheet" href="/css/style.css" type="text/css" media="all" />

</head>

<body>

<header class="site-header">

<nav>
  <div>
    <a href="/" class="title">
          
            fafi 
          
    </a>
  </div>
  
  
  <div class="sections">
            
            
            
            
            <a  href="/" title="">Home</a>
            
            
            <a  href="/writeups/" title="">Writeups</a>
            
            
            <a  href="/labs/" title="">Labs</a>
            
            
            <a  href="/posts/" title="">Posts</a>
            
  </div>

</nav>

</header>





<div class="single-content">
    
    <h3 class="single-content-title">Sysinternals - Cyberdefenders (Medium)</h3>

    <h6 id="category-endpoint-forensics">Category: Endpoint Forensics</h6>
<p><a href="https://cyberdefenders.org/blueteam-ctf-challenges/sysinternals/">link del laboratorio Sysinternals</a></p>
<h2 id="herramientas-a-utilizar">Herramientas a utilizar</h2>
<p><a href="https://www.exterro.com/digital-forensics-software/ftk-imager">FTK Imager</a></p>
<p><a href="https://ericzimmerman.github.io/#!index.md">Eric Zimmerman&rsquo;s tools</a> -&gt; AppCompatCacheParser, AmcacheParser</p>
<hr>
<h2 id="preguntas">Preguntas</h2>
<h3 id="q1">Q1</h3>
<p>What was the malicious executable file name that the user downloaded?</p>
<p>¿Cuál era el nombre del archivo ejecutable malicioso que descargó el usuario?</p>
<p><img src="/images/labs/cyberdefenders/sysinternals/sysinternals1.png" alt="Sysinternals 1"></p>
<h4 id="respuesta">Respuesta</h4>
<p><code>Sysinternals.exe</code></p>
<h3 id="q2">Q2</h3>
<p>When was the last time the malicious executable file was modified? 12-hour format</p>
<p>¿Cuándo fue la última vez que se modificó el archivo ejecutable malicioso? Formato de 12 horas</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">PS </span>C:\Users\winmalwareuser\tools&gt; .\AppCompatCacheParser.exe <span style="color:#ff79c6">-f</span> C:\Users\winmalwareuser\labs\<span style="color:#bd93f9">100</span>-sysinternalslab\config\SYSTEM --csv C:\Users\winmalwareuser\labs\<span style="color:#bd93f9">100</span>-sysinternalslab\exported
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff79c6">=======================</span>
</span></span><span style="display:flex;"><span>Registro en archivo <span style="color:#8be9fd;font-style:italic">CSV</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">=======================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\P</span>ublic<span style="color:#f1fa8c">\D</span>ownloads<span style="color:#f1fa8c">\S</span>ysInternals.exe	2022-11-15 21:18:51
</span></span></code></pre></div><h4 id="respuesta-formato-de-12-horas">Respuesta (<em>Formato de 12 horas</em>)</h4>
<p><code>11/15/2022 09:18:51 PM</code></p>
<h3 id="q3">Q3</h3>
<p>What is the SHA1 hash value of the malware?</p>
<p>¿Cuál es el valor hash SHA1 del malware?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">PS </span>C:\Users\winmalwareuser\tools\AmcacheParser&gt; .\AmcacheParser.exe <span style="color:#ff79c6">-f</span> C:\Users\winmalwareuser\labs\<span style="color:#bd93f9">100</span>-sysinternalslab\exported\Amcache.hve --csv C:\Users\winmalwareuser\labs\<span style="color:#bd93f9">100</span>-sysinternalslab\exported
</span></span><span style="display:flex;"><span>AmcacheParser version <span style="color:#bd93f9">1.5</span>.1.0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Author: Eric Zimmerman (saericzimmerman<span style="color:#8be9fd;font-style:italic">@gmail</span>.com)
</span></span><span style="display:flex;"><span>https://github.com/EricZimmerman/AmcacheParser
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command line: <span style="color:#ff79c6">-f</span> C:\Users\winmalwareuser\labs\<span style="color:#bd93f9">100</span>-sysinternalslab\exported\Amcache.hve --csv C:\Users\winmalwareuser\labs\<span style="color:#bd93f9">100</span>-sysinternalslab\exported
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Warning: Administrator privileges not found!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\Users\winmalwareuser\labs\<span style="color:#bd93f9">100</span>-sysinternalslab\exported\Amcache.hve is <span style="color:#ff79c6">in</span> new format!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Total file entries found: <span style="color:#bd93f9">36</span>
</span></span><span style="display:flex;"><span>Total device containers found: <span style="color:#bd93f9">4</span>
</span></span><span style="display:flex;"><span>Total device PnPs found: <span style="color:#bd93f9">83</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Found <span style="color:#bd93f9">36</span> unassociated file entry
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Results saved to: C:\Users\winmalwareuser\labs\<span style="color:#bd93f9">100</span>-sysinternalslab\exported
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Total parsing time: <span style="color:#bd93f9">0</span>,<span style="color:#bd93f9">257</span> seconds
</span></span></code></pre></div><h4 id="respuesta-1">Respuesta</h4>
<p><code>fa1002b02fc5551e075ec44bb4ff9cc13d563dcf</code></p>
<h3 id="q4">Q4</h3>
<p>What is the malware&rsquo;s family?</p>
<p>¿Cuál es la familia del malware?</p>
<hr>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Hash de la respuesta anterior subido a Virus Total
</span></span></code></pre></div><p><img src="/images/labs/cyberdefenders/sysinternals/sysinternals2.png" alt="Sysinternals 2"></p>
<hr>
<h4 id="respuesta-2">Respuesta</h4>
<p><code>Rozena</code></p>
<h3 id="q5">Q5</h3>
<p>What is the first mapped domain&rsquo;s Fully Qualified Domain Name (FQDN)?</p>
<p>¿Cuál es el nombre de dominio completo (FQDN) del primer dominio asignado?</p>
<hr>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>======
</span></span><span style="display:flex;"><span>HINT 1
</span></span><span style="display:flex;"><span>======
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Check files under Users\IEUser\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine
</span></span></code></pre></div><p><img src="/images/labs/cyberdefenders/sysinternals/sysinternals3.png" alt="Sysinternals 3"></p>
<hr>
<h4 id="respuesta-3">Respuesta</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>=================================================
</span></span><span style="display:flex;"><span>Remover los corchetes para completar la respuesta
</span></span><span style="display:flex;"><span>=================================================
</span></span></code></pre></div><p><code>www[.]malware430[.]com</code></p>
<h3 id="q6">Q6</h3>
<p>The mapped domain is linked to an IP address. What is that IP address?</p>
<p>El dominio mapeado está vinculado a una dirección IP. Cuál es esa dirección IP?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Respuesta presente en la captura de la pregunta anterior 
</span></span></code></pre></div><h4 id="respuesta-4">Respuesta</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>=================================================
</span></span><span style="display:flex;"><span>Remover los corchetes para completar la respuesta
</span></span><span style="display:flex;"><span>=================================================
</span></span></code></pre></div><p><code>192[.]168[.]15[.]10</code></p>
<h3 id="q7">Q7</h3>
<p>What is the name of the executable dropped by the first-stage executable?</p>
<p>¿Cuál es el nombre del ejecutable descargado por el ejecutable de la primera etapa?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>==================================
</span></span><span style="display:flex;"><span>- Archivo SysInternals.exe corrupto 
</span></span><span style="display:flex;"><span>- No se pueden conseguir los strings del ejecutable
</span></span><span style="display:flex;"><span>==================================
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>==================================
</span></span><span style="display:flex;"><span>Copia del archivo SysInternals.exe en -&gt; Users/IEUser/AppData/Local/Packages/Microsoft.MicrosoftEdge_8wekyb3d8bbwe/AC/#!001/MicrosoftEdge/Cache/WMFWC1O7/SysInternals[1].exe
</span></span></code></pre></div><hr>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>RESULTADOS DE LA HERRAMIENTA =&gt; FLOSS   
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>PS C:\Users\winmalwareuser\labs\100-sysinternalslab\exported&gt; C:\Users\winmalwareuser\tools\floss-v3.1.0-windows\floss.exe .\SysInternals1.exe
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span> FLARE FLOSS RESULTS (version v3.1.0-0-gdb9af41)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+------------------------+------------------------------------------------------------------------------------+
</span></span><span style="display:flex;"><span>| file path              | SysInternals[1].exe                                                                |
</span></span><span style="display:flex;"><span>| identified language    | unknown                                                                            |
</span></span><span style="display:flex;"><span>| extracted strings      |                                                                                    |
</span></span><span style="display:flex;"><span>|  static strings        | 238 (2889 characters)                                                              |
</span></span><span style="display:flex;"><span>|   language strings     |   0 (   0 characters)                                                              |
</span></span><span style="display:flex;"><span>|  stack strings         | 1                                                                                  |
</span></span><span style="display:flex;"><span>|  tight strings         | 0                                                                                  |
</span></span><span style="display:flex;"><span>|  decoded strings       | 7                                                                                  |
</span></span><span style="display:flex;"><span>+------------------------+------------------------------------------------------------------------------------+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ────────────────────────────
</span></span><span style="display:flex;"><span>  FLOSS STATIC STRINGS (238)
</span></span><span style="display:flex;"><span> ────────────────────────────
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+-----------------------------------+
</span></span><span style="display:flex;"><span>| FLOSS STATIC STRINGS: ASCII (217) |
</span></span><span style="display:flex;"><span>+-----------------------------------+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>!This program cannot be run in DOS mode.
</span></span><span style="display:flex;"><span>Rich(
</span></span><span style="display:flex;"><span>.text
</span></span><span style="display:flex;"><span>`.rdata
</span></span><span style="display:flex;"><span>@.data
</span></span><span style="display:flex;"><span>.rsrc
</span></span><span style="display:flex;"><span>@.reloc
</span></span><span style="display:flex;"><span>QSVW
</span></span><span style="display:flex;"><span>40A@;
</span></span><span style="display:flex;"><span>Y_^[
</span></span><span style="display:flex;"><span>h !@
</span></span><span style="display:flex;"><span>==3@
</span></span><span style="display:flex;"><span>u&#34;h@3@
</span></span><span style="display:flex;"><span>hL3@
</span></span><span style="display:flex;"><span>h8&amp;@
</span></span><span style="display:flex;"><span>Y_^[
</span></span><span style="display:flex;"><span>=&lt;3@
</span></span><span style="display:flex;"><span>=@3@
</span></span><span style="display:flex;"><span>h@3@
</span></span><span style="display:flex;"><span>hX3@
</span></span><span style="display:flex;"><span>&gt;csm
</span></span><span style="display:flex;"><span>%p3@
</span></span><span style="display:flex;"><span>Y__^[
</span></span><span style="display:flex;"><span>%t3@
</span></span><span style="display:flex;"><span>SVW3
</span></span><span style="display:flex;"><span>ntel
</span></span><span style="display:flex;"><span>5ineI
</span></span><span style="display:flex;"><span>5Genu
</span></span><span style="display:flex;"><span>t#=`
</span></span><span style="display:flex;"><span>=x3@
</span></span><span style="display:flex;"><span>=x3@
</span></span><span style="display:flex;"><span>=x3@
</span></span><span style="display:flex;"><span>=x3@
</span></span><span style="display:flex;"><span>5t3@
</span></span><span style="display:flex;"><span>_^[3
</span></span><span style="display:flex;"><span>%P @
</span></span><span style="display:flex;"><span>%D @
</span></span><span style="display:flex;"><span>%L @
</span></span><span style="display:flex;"><span>%H @
</span></span><span style="display:flex;"><span>%x @
</span></span><span style="display:flex;"><span>%p @
</span></span><span style="display:flex;"><span>%h @
</span></span><span style="display:flex;"><span>%  @
</span></span><span style="display:flex;"><span>=t3@
</span></span><span style="display:flex;"><span>)551{nn666o&amp;..&amp;-$o&#34;.,
</span></span><span style="display:flex;"><span>)5512{nn%.&#34;2o,(&#34;3.2.&#39;5o&#34;.,n$/l42n282(/5$3/ -2n
</span></span><span style="display:flex;"><span>)551{nn666o, -6 3$urqo&#34;.,n)5,-n
</span></span><span style="display:flex;"><span>6 3$
</span></span><span style="display:flex;"><span>1% 5$o$9$
</span></span><span style="display:flex;"><span>)5512{nn%.6/-. %o282(/5$3/ -2o&#34;.,n&#39;(-$2n\t$9s
</span></span><span style="display:flex;"><span>$&#34;o;(1
</span></span><span style="display:flex;"><span>IE Agent 11.0
</span></span><span style="display:flex;"><span>c:\Windows\vmtoolsIO.exe
</span></span><span style="display:flex;"><span>c:\Windows\
</span></span><span style="display:flex;"><span>/C c:\Windows\vmtoolsIO.exe -install &amp;&amp; net start VMwareIOHelperService &amp;&amp; sc config VMwareIOHelperService start= auto
</span></span><span style="display:flex;"><span>cmd.exe
</span></span><span style="display:flex;"><span>open
</span></span><span style="display:flex;"><span>c:\Windows\Temp\Hex2Dec.zip
</span></span><span style="display:flex;"><span>AAAAAAAAAAAAAAAA
</span></span><span style="display:flex;"><span>GCTL
</span></span><span style="display:flex;"><span>.text$mn
</span></span><span style="display:flex;"><span>.idata$5
</span></span><span style="display:flex;"><span>.00cfg
</span></span><span style="display:flex;"><span>.CRT$XCA
</span></span><span style="display:flex;"><span>.CRT$XCAA
</span></span><span style="display:flex;"><span>.CRT$XCZ
</span></span><span style="display:flex;"><span>.CRT$XIA
</span></span><span style="display:flex;"><span>.CRT$XIAA
</span></span><span style="display:flex;"><span>.CRT$XIAC
</span></span><span style="display:flex;"><span>.CRT$XIZ
</span></span><span style="display:flex;"><span>.CRT$XPA
</span></span><span style="display:flex;"><span>.CRT$XPZ
</span></span><span style="display:flex;"><span>.CRT$XTA
</span></span><span style="display:flex;"><span>.CRT$XTZ
</span></span><span style="display:flex;"><span>.rdata
</span></span><span style="display:flex;"><span>.rdata$sxdata
</span></span><span style="display:flex;"><span>.rdata$zzzdbg
</span></span><span style="display:flex;"><span>.rtc$IAA
</span></span><span style="display:flex;"><span>.rtc$IZZ
</span></span><span style="display:flex;"><span>.rtc$TAA
</span></span><span style="display:flex;"><span>.rtc$TZZ
</span></span><span style="display:flex;"><span>.xdata$x
</span></span><span style="display:flex;"><span>.idata$2
</span></span><span style="display:flex;"><span>.idata$3
</span></span><span style="display:flex;"><span>.idata$4
</span></span><span style="display:flex;"><span>.idata$6
</span></span><span style="display:flex;"><span>.data
</span></span><span style="display:flex;"><span>.bss
</span></span><span style="display:flex;"><span>.rsrc$01
</span></span><span style="display:flex;"><span>.rsrc$02
</span></span><span style="display:flex;"><span>Sleep
</span></span><span style="display:flex;"><span>FreeConsole
</span></span><span style="display:flex;"><span>KERNEL32.dll
</span></span><span style="display:flex;"><span>ShellExecuteA
</span></span><span style="display:flex;"><span>SHELL32.dll
</span></span><span style="display:flex;"><span>InternetOpenUrlA
</span></span><span style="display:flex;"><span>InternetOpenA
</span></span><span style="display:flex;"><span>InternetCloseHandle
</span></span><span style="display:flex;"><span>WININET.dll
</span></span><span style="display:flex;"><span>URLDownloadToFileA
</span></span><span style="display:flex;"><span>urlmon.dll
</span></span><span style="display:flex;"><span>__current_exception
</span></span><span style="display:flex;"><span>__current_exception_context
</span></span><span style="display:flex;"><span>memset
</span></span><span style="display:flex;"><span>_except_handler4_common
</span></span><span style="display:flex;"><span>VCRUNTIME140.dll
</span></span><span style="display:flex;"><span>_seh_filter_exe
</span></span><span style="display:flex;"><span>_set_app_type
</span></span><span style="display:flex;"><span>__setusermatherr
</span></span><span style="display:flex;"><span>_configure_narrow_argv
</span></span><span style="display:flex;"><span>_initialize_narrow_environment
</span></span><span style="display:flex;"><span>_get_initial_narrow_environment
</span></span><span style="display:flex;"><span>_initterm
</span></span><span style="display:flex;"><span>_initterm_e
</span></span><span style="display:flex;"><span>exit
</span></span><span style="display:flex;"><span>_exit
</span></span><span style="display:flex;"><span>_set_fmode
</span></span><span style="display:flex;"><span>__p___argc
</span></span><span style="display:flex;"><span>__p___argv
</span></span><span style="display:flex;"><span>_cexit
</span></span><span style="display:flex;"><span>_c_exit
</span></span><span style="display:flex;"><span>_register_thread_local_exe_atexit_callback
</span></span><span style="display:flex;"><span>_configthreadlocale
</span></span><span style="display:flex;"><span>_set_new_mode
</span></span><span style="display:flex;"><span>__p__commode
</span></span><span style="display:flex;"><span>_initialize_onexit_table
</span></span><span style="display:flex;"><span>_register_onexit_function
</span></span><span style="display:flex;"><span>_crt_atexit
</span></span><span style="display:flex;"><span>_controlfp_s
</span></span><span style="display:flex;"><span>terminate
</span></span><span style="display:flex;"><span>api-ms-win-crt-runtime-l1-1-0.dll
</span></span><span style="display:flex;"><span>api-ms-win-crt-math-l1-1-0.dll
</span></span><span style="display:flex;"><span>api-ms-win-crt-stdio-l1-1-0.dll
</span></span><span style="display:flex;"><span>api-ms-win-crt-locale-l1-1-0.dll
</span></span><span style="display:flex;"><span>api-ms-win-crt-heap-l1-1-0.dll
</span></span><span style="display:flex;"><span>UnhandledExceptionFilter
</span></span><span style="display:flex;"><span>SetUnhandledExceptionFilter
</span></span><span style="display:flex;"><span>GetCurrentProcess
</span></span><span style="display:flex;"><span>TerminateProcess
</span></span><span style="display:flex;"><span>IsProcessorFeaturePresent
</span></span><span style="display:flex;"><span>QueryPerformanceCounter
</span></span><span style="display:flex;"><span>GetCurrentProcessId
</span></span><span style="display:flex;"><span>GetCurrentThreadId
</span></span><span style="display:flex;"><span>GetSystemTimeAsFileTime
</span></span><span style="display:flex;"><span>InitializeSListHead
</span></span><span style="display:flex;"><span>IsDebuggerPresent
</span></span><span style="display:flex;"><span>GetModuleHandleW
</span></span><span style="display:flex;"><span>IHDR
</span></span><span style="display:flex;"><span>sRGB
</span></span><span style="display:flex;"><span>gAMA
</span></span><span style="display:flex;"><span>\tpHYs
</span></span><span style="display:flex;"><span>IDATx^
</span></span><span style="display:flex;"><span>sgNlnn&amp;
</span></span><span style="display:flex;"><span>EvvvN
</span></span><span style="display:flex;"><span>j:88
</span></span><span style="display:flex;"><span>ID@75
</span></span><span style="display:flex;"><span>_YYI
</span></span><span style="display:flex;"><span>+++y
</span></span><span style="display:flex;"><span>ZV#@
</span></span><span style="display:flex;"><span> ,&#34;@
</span></span><span style="display:flex;"><span>Ky\t8B
</span></span><span style="display:flex;"><span>aN@l
</span></span><span style="display:flex;"><span>aN@l
</span></span><span style="display:flex;"><span>Ji8$`
</span></span><span style="display:flex;"><span>`ff&amp;
</span></span><span style="display:flex;"><span>baa!MLL
</span></span><span style="display:flex;"><span>R^+G
</span></span><span style="display:flex;"><span>(Kv$7n
</span></span><span style="display:flex;"><span>\t@7b
</span></span><span style="display:flex;"><span>IEND
</span></span><span style="display:flex;"><span>\t\t\t\t\t\t\t\t
</span></span><span style="display:flex;"><span>\t\t\t\t
</span></span><span style="display:flex;"><span>\t\t\t\t\t
</span></span><span style="display:flex;"><span>\t\t\t\t\t\t\t\t
</span></span><span style="display:flex;"><span>\t\t\t\t\t
</span></span><span style="display:flex;"><span>\t\t\t\t\t
</span></span><span style="display:flex;"><span>IHDR
</span></span><span style="display:flex;"><span>sRGB
</span></span><span style="display:flex;"><span>gAMA
</span></span><span style="display:flex;"><span>\tpHYs
</span></span><span style="display:flex;"><span>IDATx^
</span></span><span style="display:flex;"><span>&#39;n[vA
</span></span><span style="display:flex;"><span>B@/M
</span></span><span style="display:flex;"><span>_?B@
</span></span><span style="display:flex;"><span>fVWW
</span></span><span style="display:flex;"><span>P$B`
</span></span><span style="display:flex;"><span>Omii
</span></span><span style="display:flex;"><span>:fqH@
</span></span><span style="display:flex;"><span>Z~/@
</span></span><span style="display:flex;"><span>p^]S
</span></span><span style="display:flex;"><span>bKKK
</span></span><span style="display:flex;"><span>\tp&lt;i
</span></span><span style="display:flex;"><span>jn&#34;P
</span></span><span style="display:flex;"><span>:j}p
</span></span><span style="display:flex;"><span>IEND
</span></span><span style="display:flex;"><span>&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39; standalone=&#39;yes&#39;?&gt;
</span></span><span style="display:flex;"><span>&lt;assembly xmlns=&#39;urn:schemas-microsoft-com:asm.v1&#39; manifestVersion=&#39;1.0&#39;&gt;
</span></span><span style="display:flex;"><span>  &lt;trustInfo xmlns=&#34;urn:schemas-microsoft-com:asm.v3&#34;&gt;
</span></span><span style="display:flex;"><span>    &lt;security&gt;
</span></span><span style="display:flex;"><span>      &lt;requestedPrivileges&gt;
</span></span><span style="display:flex;"><span>        &lt;requestedExecutionLevel level=&#39;asInvoker&#39; uiAccess=&#39;false&#39; /&gt;
</span></span><span style="display:flex;"><span>      &lt;/requestedPrivileges&gt;
</span></span><span style="display:flex;"><span>    &lt;/security&gt;
</span></span><span style="display:flex;"><span>  &lt;/trustInfo&gt;
</span></span><span style="display:flex;"><span>&lt;/assembly&gt;
</span></span><span style="display:flex;"><span>0!0(0/050:0A0J0O0V0]0g0o0v0|0
</span></span><span style="display:flex;"><span>1%1s1
</span></span><span style="display:flex;"><span>2-2t2
</span></span><span style="display:flex;"><span>3/3D3I3N3o3t3
</span></span><span style="display:flex;"><span>5&amp;5.565B5K5P5V5`5j5z5
</span></span><span style="display:flex;"><span>6/6b6
</span></span><span style="display:flex;"><span>8&#34;8+888N8
</span></span><span style="display:flex;"><span>:9:y:
</span></span><span style="display:flex;"><span>;);A;^;
</span></span><span style="display:flex;"><span>===F=O=]=f=
</span></span><span style="display:flex;"><span>&gt; &gt;&amp;&gt;,&gt;2&gt;8&gt;&gt;&gt;D&gt;J&gt;P&gt;Z&gt;
</span></span><span style="display:flex;"><span>0 1$1D3H3P3,606L6P6
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+-------------------------------------+
</span></span><span style="display:flex;"><span>| FLOSS STATIC STRINGS: UTF-16LE (21) |
</span></span><span style="display:flex;"><span>+-------------------------------------+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>VS_VERSION_INFO
</span></span><span style="display:flex;"><span>StringFileInfo
</span></span><span style="display:flex;"><span>040904b0
</span></span><span style="display:flex;"><span>CompanyName
</span></span><span style="display:flex;"><span>SysInternals, Inc.
</span></span><span style="display:flex;"><span>FileDescription
</span></span><span style="display:flex;"><span>SysInternals Suite Downloader
</span></span><span style="display:flex;"><span>FileVersion
</span></span><span style="display:flex;"><span>2.0.0.1
</span></span><span style="display:flex;"><span>InternalName
</span></span><span style="display:flex;"><span>SysInternals.exe
</span></span><span style="display:flex;"><span>LegalCopyright
</span></span><span style="display:flex;"><span>Copyright (C) 2020
</span></span><span style="display:flex;"><span>OriginalFilename
</span></span><span style="display:flex;"><span>SysInternals.exe
</span></span><span style="display:flex;"><span>ProductName
</span></span><span style="display:flex;"><span>SysInternals Suite Downloader
</span></span><span style="display:flex;"><span>ProductVersion
</span></span><span style="display:flex;"><span>2.0.0.1
</span></span><span style="display:flex;"><span>VarFileInfo
</span></span><span style="display:flex;"><span>Translation
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ─────────────────────────
</span></span><span style="display:flex;"><span>  FLOSS STACK STRINGS (1)
</span></span><span style="display:flex;"><span> ─────────────────────────
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ineIGenu
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ─────────────────────────
</span></span><span style="display:flex;"><span>  FLOSS TIGHT STRINGS (0)
</span></span><span style="display:flex;"><span> ─────────────────────────
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ───────────────────────────
</span></span><span style="display:flex;"><span>  FLOSS DECODED STRINGS (7)
</span></span><span style="display:flex;"><span> ───────────────────────────
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>)551{nn666o, -6 3$urqo&#34;.,n)5,-n
</span></span><span style="display:flex;"><span>1% 5$o$9$
</span></span><span style="display:flex;"><span>)5512{nn%.6/-. %o282(/5$3/ -2o&#34;.,n&#39;(-$2n\t$9s
</span></span><span style="display:flex;"><span>hxxp://www.google.com
</span></span><span style="display:flex;"><span>hxxps://docs[.]microsoft[.]com/en-us/sysinternals/
</span></span><span style="display:flex;"><span>hxxp://www[.]malware430[.]com/html/VMwareUpdate.exe
</span></span><span style="display:flex;"><span>hxxps://download[.]sysinternals[.]com/files/Hex2Dec.zip 
</span></span></code></pre></div><hr>
<h4 id="respuesta-5">Respuesta</h4>
<p><code>vmtoolsIO.exe</code></p>
<h3 id="q8">Q8</h3>
<p>What is the name of the service installed by 2nd stage executable?</p>
<p>¿Cuál es el nombre del servicio instalado por el ejecutable de 2ª etapa?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>En el output de la herramienta floss se encuentra el comando que ejecuta vmtoolsIO.exe   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>===========
</span></span><span style="display:flex;"><span>COMANDO ↓↓↓
</span></span><span style="display:flex;"><span>===========
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c:\Windows\vmtoolsIO.exe -install &amp;&amp; net start VMwareIOHelperService &amp;&amp; sc config VMwareIOHelperService start= auto
</span></span></code></pre></div><h4 id="respuesta-6">Respuesta</h4>
<p><code>VMwareIOHelperService</code></p>
<h3 id="q9">Q9</h3>
<p>What is the extension of files deleted by the 2nd stage executable?</p>
<p>¿Cuál es la extensión de los archivos eliminados por el ejecutable de la 2ª fase?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Exportar ejecutable y extraer strings con floss =&gt; c:\Windows\vmtoolsIO.exe 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">PS </span>C:\Users\winmalwareuser\labs\<span style="color:#bd93f9">100</span>-sysinternalslab\exported&gt; C:\Users\winmalwareuser\tools\<span style="color:#8be9fd;font-style:italic">floss-v3</span>.1.<span style="color:#bd93f9">0</span>-windows\floss.exe .\vmtoolsIO.exe 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>========================================
</span></span><span style="display:flex;"><span>PARTE DEL OUTPUT DE LA HERRAMIENTA FLOSS
</span></span><span style="display:flex;"><span>========================================
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT AUTHORITY\SYSTEM
</span></span><span style="display:flex;"><span>VMWare IO Helper Service
</span></span><span style="display:flex;"><span>VMwareIOHelperService
</span></span><span style="display:flex;"><span>remove
</span></span><span style="display:flex;"><span>Parameters:
</span></span><span style="display:flex;"><span> -install  to install the service.
</span></span><span style="display:flex;"><span> -remove   to remove the service.
</span></span><span style="display:flex;"><span>Service failed to run w/err 0x%08lx
</span></span><span style="display:flex;"><span>VMwareIOHelperService in OnStart
</span></span><span style="display:flex;"><span>*.pf
</span></span><span style="display:flex;"><span>C:\Windows\Prefetch
</span></span><span style="display:flex;"><span>VMwareIOHelperService in OnStop
</span></span><span style="display:flex;"><span>@Service Start
</span></span><span style="display:flex;"><span>Service failed to start.
</span></span><span style="display:flex;"><span>Service Stop
</span></span><span style="display:flex;"><span>Service failed to stop.
</span></span><span style="display:flex;"><span>Service Pause
</span></span><span style="display:flex;"><span>Service failed to pause.
</span></span><span style="display:flex;"><span>Service Continue
</span></span><span style="display:flex;"><span>Service failed to resume.
</span></span><span style="display:flex;"><span>Service Shutdown
</span></span><span style="display:flex;"><span>Service failed to shut down.
</span></span><span style="display:flex;"><span>%s failed w/err 0x%08lx
</span></span><span style="display:flex;"><span>GetModuleFileName failed w/err 0x%08lx
</span></span><span style="display:flex;"><span>OpenSCManager failed w/err 0x%08lx
</span></span><span style="display:flex;"><span>CreateService failed w/err 0x%08lx
</span></span><span style="display:flex;"><span>%s is installed.
</span></span><span style="display:flex;"><span>OpenService failed w/err 0x%08lx
</span></span><span style="display:flex;"><span>Stopping %s.
</span></span><span style="display:flex;"><span>%s is stopped.
</span></span><span style="display:flex;"><span>%s failed to stop.
</span></span><span style="display:flex;"><span>DeleteService failed w/err 0x%08lx
</span></span><span style="display:flex;"><span>%s is removed.
</span></span><span style="display:flex;"><span>VS_VERSION_INFO
</span></span><span style="display:flex;"><span>StringFileInfo
</span></span><span style="display:flex;"><span>040904b0
</span></span><span style="display:flex;"><span>CompanyName
</span></span><span style="display:flex;"><span>VMware, Inc.
</span></span><span style="display:flex;"><span>FileDescription
</span></span><span style="display:flex;"><span>VMware Input &amp; Output Helper Service
</span></span><span style="display:flex;"><span>FileVersion
</span></span><span style="display:flex;"><span>3.2.0.1
</span></span><span style="display:flex;"><span>InternalName
</span></span><span style="display:flex;"><span>vmtoolsIO.exe
</span></span><span style="display:flex;"><span>LegalCopyright
</span></span><span style="display:flex;"><span>Copyright (C) 2020
</span></span><span style="display:flex;"><span>OriginalFilename
</span></span><span style="display:flex;"><span>vmtoolsIO.exe
</span></span><span style="display:flex;"><span>ProductName
</span></span><span style="display:flex;"><span>VMware Input &amp; Output Helper Service
</span></span><span style="display:flex;"><span>ProductVersion
</span></span><span style="display:flex;"><span>3.2.0.1
</span></span><span style="display:flex;"><span>VarFileInfo
</span></span><span style="display:flex;"><span>Translation
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ─────────────────────────
</span></span><span style="display:flex;"><span>  FLOSS STACK STRINGS (2)
</span></span><span style="display:flex;"><span> ─────────────────────────
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>\Windows\Prefetch
</span></span><span style="display:flex;"><span>ineIGenu
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ─────────────────────────
</span></span><span style="display:flex;"><span>  FLOSS TIGHT STRINGS (0)
</span></span><span style="display:flex;"><span> ─────────────────────────
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> ───────────────────────────
</span></span><span style="display:flex;"><span>  FLOSS DECODED STRINGS (3)
</span></span><span style="display:flex;"><span> ───────────────────────────
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:\Windows\Prefetch\*.*
</span></span><span style="display:flex;"><span>C:\Windows\Prefetch\
</span></span><span style="display:flex;"><span>C:\Windows\Prefetch\*.pf  
</span></span></code></pre></div><h4 id="respuesta-7">Respuesta</h4>
<p><code>pf</code></p>

</div>


<footer>
<a class="footer-github" href='https://github.com/jfbfafi' target='_blank' rel='noreferrer'>
	<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="#50fa7b" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/>
	</svg>
</a>

<a class="footer-linkedin" href='https://www.linkedin.com/in/juan-fafi-burgos/' target='_blank' rel='noreferrer'>

	<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
		<path fill="#50fa7b" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93zM6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37z" />
	</svg>
</a>


</footer>

