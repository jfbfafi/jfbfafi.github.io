<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4444&amp;path=livereload" data-no-instant defer></script>

	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<title>dawn - Vulnhub (easy) |  fafi </title>
    

	<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
    <link rel="android-chrome-192x192" type="image/png" sizes="192x192" href="/images/android-chrome-192x192.png">
    <link rel="android-chrome-512x512" type="image/png" sizes="512x512" href="/images/android-chrome-512x512.png">
    <link rel="manifest" href="/images/site.webmanifest">

	<link rel="stylesheet" href="/css/style.css" type="text/css" media="all" />

</head>

<body>

<header class="site-header">

<nav>
  <div>
    <a href="/" class="title">
          
            fafi 
          
    </a>
  </div>
  
  
  <div class="sections">
            
            
            
            
            <a  href="/" title="">Home</a>
            
            
            <a  href="/writeups/" title="">Writeups</a>
            
            
            <a  href="/labs/" title="">Labs</a>
            
            
            <a  href="/posts/" title="">Posts</a>
            
  </div>

</nav>

</header>





<div class="single-content">
    
    <h3 class="single-content-title">dawn - Vulnhub (easy)</h3>

    <h2 id="escaneo-de-red-con-nmap-para-descubrir-máquina-objetivo">Escaneo de red con nmap para descubrir máquina objetivo</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sn 10.3.3.0/24
</span></span></code></pre></div><p><img src="/images/writeups/vulnhub/dawn/nmaphd.png" alt="nmaphd"></p>
<h3 id="la-ip-de-la-máquina-objetivo-es-103320">La IP de la máquina objetivo es <strong>10.3.3.20</strong></h3>
<h2 id="escaneo-de-la-máquina-objetivo-en-busca-de-puertos-abiertos">Escaneo de la máquina objetivo en busca de puertos abiertos</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -p- --open -sS --min-rate <span style="color:#bd93f9">5000</span> -vvv -n -Pn 10.3.3.20 -oN target_scan.nmap
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Host discovery disabled <span style="color:#ff79c6">(</span>-Pn<span style="color:#ff79c6">)</span>. All addresses will be marked <span style="color:#f1fa8c">&#39;up&#39;</span> and scan <span style="color:#8be9fd;font-style:italic">times</span> may be slower.
</span></span><span style="display:flex;"><span>Starting Nmap 7.94SVN <span style="color:#ff79c6">(</span> https://nmap.org <span style="color:#ff79c6">)</span> at 2024-03-12 15:42 EDT
</span></span><span style="display:flex;"><span>Initiating ARP Ping Scan at 15:42
</span></span><span style="display:flex;"><span>Scanning 10.3.3.20 <span style="color:#ff79c6">[</span><span style="color:#bd93f9">1</span> port<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>Completed ARP Ping Scan at 15:42, 0.06s elapsed <span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span> total hosts<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Initiating SYN Stealth Scan at 15:42
</span></span><span style="display:flex;"><span>Scanning 10.3.3.20 <span style="color:#ff79c6">[</span><span style="color:#bd93f9">65535</span> ports<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>Discovered open port 139/tcp on 10.3.3.20
</span></span><span style="display:flex;"><span>Discovered open port 80/tcp on 10.3.3.20
</span></span><span style="display:flex;"><span>Discovered open port 445/tcp on 10.3.3.20
</span></span><span style="display:flex;"><span>Discovered open port 3306/tcp on 10.3.3.20
</span></span><span style="display:flex;"><span>Completed SYN Stealth Scan at 15:42, 1.41s elapsed <span style="color:#ff79c6">(</span><span style="color:#bd93f9">65535</span> total ports<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#ff79c6">for</span> 10.3.3.20
</span></span><span style="display:flex;"><span>Host is up, received arp-response <span style="color:#ff79c6">(</span>0.00013s latency<span style="color:#ff79c6">)</span>.
</span></span><span style="display:flex;"><span>Scanned at 2024-03-12 15:42:28 EDT <span style="color:#ff79c6">for</span> 2s
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#bd93f9">65531</span> closed tcp ports <span style="color:#ff79c6">(</span>reset<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE      REASON
</span></span><span style="display:flex;"><span>80/tcp   open  http         syn-ack ttl <span style="color:#bd93f9">64</span>
</span></span><span style="display:flex;"><span>139/tcp  open  netbios-ssn  syn-ack ttl <span style="color:#bd93f9">64</span>
</span></span><span style="display:flex;"><span>445/tcp  open  microsoft-ds syn-ack ttl <span style="color:#bd93f9">64</span>
</span></span><span style="display:flex;"><span>3306/tcp open  mysql        syn-ack ttl <span style="color:#bd93f9">64</span>
</span></span><span style="display:flex;"><span>MAC Address: 08:00:27:43:01:ED <span style="color:#ff79c6">(</span>Oracle VirtualBox virtual NIC<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style="display:flex;"><span>Nmap <span style="color:#ff79c6">done</span>: <span style="color:#bd93f9">1</span> IP address <span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span> host up<span style="color:#ff79c6">)</span> scanned in 1.78 seconds
</span></span><span style="display:flex;"><span>           Raw packets sent: <span style="color:#bd93f9">65536</span> <span style="color:#ff79c6">(</span>2.884MB<span style="color:#ff79c6">)</span> | Rcvd: <span style="color:#bd93f9">65536</span> <span style="color:#ff79c6">(</span>2.621MB<span style="color:#ff79c6">)</span>
</span></span></code></pre></div><h3 id="puertos-abiertos-801394453306"><strong>Puertos Abiertos: 80,139,445,3306</strong></h3>
<h2 id="ejecución-de-scripts-con-nmap">Ejecución de scripts con nmap</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -sCV -p80,139,445,3306 10.3.3.20 -oN scripts_exec.nmap
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Host is up <span style="color:#ff79c6">(</span>0.00044s latency<span style="color:#ff79c6">)</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE     VERSION
</span></span><span style="display:flex;"><span>80/tcp   open  http        Apache httpd 2.4.38 <span style="color:#ff79c6">((</span>Debian<span style="color:#ff79c6">))</span>
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.38 <span style="color:#ff79c6">(</span>Debian<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Site doesn<span style="color:#f1fa8c">&#39;t have a title (text/html).
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">445/tcp  open  netbios-ssn Samba smbd 4.9.5-Debian (workgroup: WORKGROUP)
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">3306/tcp open  mysql       MySQL 5.5.5-10.3.15-MariaDB-1
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">| mysql-info: 
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">|   Protocol: 10
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">|   Version: 5.5.5-10.3.15-MariaDB-1
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">|   Thread ID: 12
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">|   Capabilities flags: 63486
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">|   Some Capabilities: ODBCClient, SupportsLoadDataLocal, InteractiveClient, LongColumnFlag, SupportsCompression, ConnectWithDatabase, SupportsTransactions, Speaks41ProtocolOld, IgnoreSigpipes, Support41Auth, FoundRows, Speaks41ProtocolNew, IgnoreSpaceBeforeParenthesis, DontAllowDatabaseTableColumn, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">|   Status: Autocommit
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">|   Salt: cJ*2\X&#39;</span>TR<span style="color:#ff79c6">}</span>Ct?|tS!H&#39;*
</span></span><span style="display:flex;"><span>|_  Auth Plugin Name: mysql_native_password
</span></span><span style="display:flex;"><span>MAC Address: 08:00:27:43:01:ED <span style="color:#ff79c6">(</span>Oracle VirtualBox virtual NIC<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>Service Info: Host: DAWN
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Host script results:
</span></span><span style="display:flex;"><span>| smb-os-discovery: 
</span></span><span style="display:flex;"><span>|   OS: Windows 6.1 <span style="color:#ff79c6">(</span>Samba 4.9.5-Debian<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>|   Computer name: dawn
</span></span><span style="display:flex;"><span>|   NetBIOS computer name: DAWN<span style="color:#f1fa8c">\x</span><span style="color:#bd93f9">00</span>
</span></span><span style="display:flex;"><span>|   Domain name: dawn
</span></span><span style="display:flex;"><span>|   FQDN: dawn.dawn
</span></span><span style="display:flex;"><span>|_  System time: 2024-03-12T15:45:17-04:00
</span></span><span style="display:flex;"><span>| smb2-time: 
</span></span><span style="display:flex;"><span>|   date: 2024-03-12T19:45:17
</span></span><span style="display:flex;"><span>|_  start_date: N/A
</span></span><span style="display:flex;"><span>| smb-security-mode: 
</span></span><span style="display:flex;"><span>|   account_used: guest
</span></span><span style="display:flex;"><span>|   authentication_level: user
</span></span><span style="display:flex;"><span>|   challenge_response: supported
</span></span><span style="display:flex;"><span>|_  message_signing: disabled <span style="color:#ff79c6">(</span>dangerous, but default<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>|_nbstat: NetBIOS name: DAWN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; <span style="color:#ff79c6">(</span>unknown<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>|_clock-skew: mean: 1h19m59s, deviation: 2h18m33s, median: 0s
</span></span><span style="display:flex;"><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span>|   3:1:1: 
</span></span><span style="display:flex;"><span>|_    Message signing enabled but not required
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#ff79c6">done</span>: <span style="color:#bd93f9">1</span> IP address <span style="color:#ff79c6">(</span><span style="color:#bd93f9">1</span> host up<span style="color:#ff79c6">)</span> scanned in 12.56 seconds
</span></span></code></pre></div><h2 id="enumeración-de-directorios-con-gobuster">Enumeración de directorios con gobuster</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gobuster dir -u http://10.3.3.20/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.6
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#ff79c6">(</span>@TheColonial<span style="color:#ff79c6">)</span> &amp; Christian Mehlmauer <span style="color:#ff79c6">(</span>@firefart<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Url:                     http://10.3.3.20/
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Method:                  GET
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Threads:                 <span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Negative Status codes:   <span style="color:#bd93f9">404</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>+<span style="color:#ff79c6">]</span> Timeout:                 <span style="color:#8be9fd;font-style:italic">10s</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span><span style="display:flex;"><span>Starting gobuster in directory enumeration <span style="color:#8be9fd;font-style:italic">mode</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span><span style="display:flex;"><span>/.htpasswd            <span style="color:#ff79c6">(</span>Status: 403<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>Size: 293<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>/.hta                 <span style="color:#ff79c6">(</span>Status: 403<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>Size: 288<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>/.htaccess            <span style="color:#ff79c6">(</span>Status: 403<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>Size: 293<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>/index.html           <span style="color:#ff79c6">(</span>Status: 200<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>Size: 791<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>/logs                 <span style="color:#ff79c6">(</span>Status: 301<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>Size: 305<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">[</span>--&gt; http://10.3.3.20/logs/<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>/server-status        <span style="color:#ff79c6">(</span>Status: 403<span style="color:#ff79c6">)</span> <span style="color:#ff79c6">[</span>Size: 297<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>Progress: <span style="color:#bd93f9">4727</span> / <span style="color:#bd93f9">4727</span> <span style="color:#ff79c6">(</span>100.00%<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">Finished</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">===============================================================</span>
</span></span></code></pre></div><h2 id="archivo-managementlog-encontrado-en-http103320logs">Archivo management.log encontrado en http://10.3.3.20/logs/</h2>
<p><img src="/images/writeups/vulnhub/dawn/managementlog.png" alt="management.log"></p>
<h2 id="registro-de-cronjob-en-el-contenido-del-archivo-de-log">Registro de cronjob en el contenido del archivo de log</h2>
<p><img src="/images/writeups/vulnhub/dawn/cronjob.png" alt="cronjob"></p>
<h2 id="conexión-al-servicio-samba-y-subida-de-archivo-web-control-que-se-ejecuta-cada-cierto-tiempo-y-contiene-una-reverse-shell">Conexión al servicio samba y subida de archivo web-control que se ejecuta cada cierto tiempo y contiene una reverse shell</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>smbclient --no-pass //10.3.3.20/ITDEPT
</span></span></code></pre></div><p><img src="/images/writeups/vulnhub/dawn/revshell.png" alt="revshell"></p>
<h2 id="privesc">Privesc</h2>
<p><img src="/images/writeups/vulnhub/dawn/sudoperms.png" alt="sudoperms"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo sudo /bin/sh
</span></span></code></pre></div><p><img src="/images/writeups/vulnhub/dawn/flagroot.png" alt="flagroot"></p>

</div>


<footer>
<a class="footer-github" href='https://github.com/jfbfafi' target='_blank' rel='noreferrer'>
	<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="#50fa7b" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/>
	</svg>
</a>

<a class="footer-linkedin" href='https://www.linkedin.com/in/juan-fafi-burgos/' target='_blank' rel='noreferrer'>

	<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
		<path fill="#50fa7b" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2zm-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93zM6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37z" />
	</svg>
</a>


</footer>

